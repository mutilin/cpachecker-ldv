# 1 "../VeriSec/MADWiFiCVE-2006-6332encode_ie_interproc_bad.cil.c"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "../VeriSec/MADWiFiCVE-2006-6332encode_ie_interproc_bad.cil.c"
# 14 "../versisec/MadWiFi/progs/../lib/stubs.h"
typedef int size_t;
# 3 "../versisec/MadWiFi/progs/../constants.h"
typedef unsigned int u_int;
# 4 "../versisec/MadWiFi/progs/../constants.h"
typedef unsigned char u_int8_t;
# 6 "../versisec/MadWiFi/progs/../constants.h"
struct ieee80211_scan_entry {
   u_int8_t *se_rsn_ie ;
};
# 32 "../versisec/MadWiFi/progs/../lib/stubs.h"
extern void *memcpy(void *dest , void const *src , size_t n ) ;
# 71 "/usr/include/assert.h"
extern __attribute__((__nothrow__, __noreturn__)) void __assert_fail(char const *__assertion ,
                                                                      char const *__file ,
                                                                      unsigned int __line ,
                                                                      char const *__function ) ;
# 4 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
static u_int encode_ie(void *buf , size_t bufsize , u_int8_t const *ie , size_t ielen ,
                       char const *leader , size_t leader_len )
{ void *bufend ;
  u_int8_t *p ;
  int i ;
  int tmp ;
  void *__cil_tmp11 ;
  void const *__cil_tmp12 ;
  unsigned long __cil_tmp13 ;
  unsigned long __cil_tmp14 ;
  unsigned long __cil_tmp15 ;
  u_int8_t *__cil_tmp16 ;
  unsigned long __cil_tmp17 ;
  u_int8_t *__cil_tmp18 ;
  u_int8_t *__cil_tmp19 ;

  {
# 9 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  bufend = buf + bufsize;
# 16 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  if (bufsize < leader_len) {
# 17 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    return (0U);
  } else {

  }
  {
# 18 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  p = (u_int8_t *)buf;
# 19 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp11 = (void *)p;
# 19 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp12 = (void const *)leader;
# 19 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  memcpy(__cil_tmp11, __cil_tmp12, leader_len);
# 20 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  bufsize = bufsize - leader_len;
# 21 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  p = p + leader_len;
# 23 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  i = 0;
  }
  {
# 23 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  while (1) {
    while_0_continue: ;
# 23 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    if (i < ielen) {
# 23 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      if (bufsize > 2) {

      } else {
        goto while_0_break;
      }
    } else {
      goto while_0_break;
    }
    {
# 34 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp13 = (unsigned long )bufend;
# 34 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp14 = (unsigned long )p;
# 34 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    if (__cil_tmp14 < __cil_tmp13) {

    } else {
      {
# 34 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __assert_fail("p < bufend", "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c",
                    34U, "encode_ie");
      }
    }
    }
# 35 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    *p = (unsigned char )'x';
    {
# 38 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp15 = (unsigned long )bufend;
# 38 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp16 = p + 1;
# 38 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp17 = (unsigned long )__cil_tmp16;
# 38 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    if (__cil_tmp17 < __cil_tmp15) {

    } else {
      {
# 38 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __assert_fail("p+1 < bufend", "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c",
                    38U, "encode_ie");
      }
    }
    }
# 39 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp18 = p + 1;
# 39 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    *__cil_tmp18 = (unsigned char )'x';
# 40 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    p = p + 2;
# 23 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    i = i + 1;
  }
  while_0_break: ;
  }
# 45 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  if (i == ielen) {
# 45 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp19 = (u_int8_t *)buf;
# 45 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    tmp = p - __cil_tmp19;
  } else {
# 45 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    tmp = 0;
  }
# 45 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  return ((unsigned int )tmp);
}
}
# 49 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
static int giwscan_cb(struct ieee80211_scan_entry const *se )
{ u_int8_t buf[6] ;
  char rsn_leader[1] ;
  void *__cil_tmp4 ;
  unsigned long __cil_tmp5 ;
  u_int8_t *__cil_tmp6 ;
  unsigned long __cil_tmp7 ;
  u_int8_t *__cil_tmp8 ;
  u_int8_t *__cil_tmp9 ;
  u_int8_t __cil_tmp10 ;
  int __cil_tmp11 ;
  unsigned long __cil_tmp12 ;
  unsigned long __cil_tmp13 ;
  u_int8_t *__cil_tmp14 ;
  void *__cil_tmp15 ;
  int __cil_tmp16 ;
  u_int8_t *__cil_tmp17 ;
  u_int8_t const *__cil_tmp18 ;
  u_int8_t *__cil_tmp19 ;
  u_int8_t *__cil_tmp20 ;
  u_int8_t __cil_tmp21 ;
  int __cil_tmp22 ;
  int __cil_tmp23 ;
  unsigned long __cil_tmp24 ;
  unsigned long __cil_tmp25 ;
  char *__cil_tmp26 ;
  char const *__cil_tmp27 ;
  int __cil_tmp28 ;

  {
  {
# 57 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp4 = (void *)0;
# 57 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp5 = (unsigned long )__cil_tmp4;
# 57 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp6 = *((u_int8_t * const *)se);
# 57 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp7 = (unsigned long )__cil_tmp6;
# 57 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  if (__cil_tmp7 != __cil_tmp5) {
    {
# 58 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp8 = *((u_int8_t * const *)se);
# 58 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp9 = __cil_tmp8 + 0;
# 58 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp10 = *__cil_tmp9;
# 58 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    __cil_tmp11 = (int )__cil_tmp10;
# 58 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
    if (__cil_tmp11 == 200) {
      {
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp12 = 0 * 1UL;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp13 = (unsigned long )(buf) + __cil_tmp12;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp14 = (u_int8_t *)__cil_tmp13;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp15 = (void *)__cil_tmp14;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp16 = (int )6UL;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp17 = *((u_int8_t * const *)se);
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp18 = (u_int8_t const *)__cil_tmp17;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp19 = *((u_int8_t * const *)se);
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp20 = __cil_tmp19 + 1;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp21 = *__cil_tmp20;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp22 = (int )__cil_tmp21;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp23 = __cil_tmp22 + 2;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp24 = 0 * 1UL;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp25 = (unsigned long )(rsn_leader) + __cil_tmp24;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp26 = (char *)__cil_tmp25;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp27 = (char const *)__cil_tmp26;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      __cil_tmp28 = (int )1UL;
# 59 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
      encode_ie(__cil_tmp15, __cil_tmp16, __cil_tmp18, __cil_tmp23, __cil_tmp27, __cil_tmp28);
      }
    } else {

    }
    }
  } else {

  }
  }
# 64 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  return (0);
}
}
# 67 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
int main(void)
{ struct ieee80211_scan_entry se ;
  u_int8_t ie[5] ;
  struct ieee80211_scan_entry *__cil_tmp3 ;
  unsigned long __cil_tmp4 ;
  unsigned long __cil_tmp5 ;
  struct ieee80211_scan_entry *__cil_tmp6 ;
  u_int8_t *__cil_tmp7 ;
  u_int8_t *__cil_tmp8 ;
  struct ieee80211_scan_entry *__cil_tmp9 ;
  u_int8_t *__cil_tmp10 ;
  u_int8_t *__cil_tmp11 ;
  struct ieee80211_scan_entry const *__cil_tmp12 ;

  {
  {
# 71 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp3 = & se;
# 71 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp4 = 0 * 1UL;
# 71 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp5 = (unsigned long )(ie) + __cil_tmp4;
# 71 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  *((u_int8_t **)__cil_tmp3) = (u_int8_t *)__cil_tmp5;
# 72 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp6 = & se;
# 72 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp7 = *((u_int8_t **)__cil_tmp6);
# 72 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp8 = __cil_tmp7 + 0;
# 72 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  *__cil_tmp8 = (unsigned char)200;
# 73 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp9 = & se;
# 73 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp10 = *((u_int8_t **)__cil_tmp9);
# 73 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp11 = __cil_tmp10 + 1;
# 73 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  *__cil_tmp11 = (unsigned char)3;
# 75 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  __cil_tmp12 = (struct ieee80211_scan_entry const *)(& se);
# 75 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  giwscan_cb(__cil_tmp12);
  }
# 77 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
  return (0);
}
}
